image:
  repository: hireflow/notifications
  tag: local
  pullPolicy: IfNotPresent

replicaCount: 0

keda:
  enabled: true
  minReplicaCount: 0
  maxReplicaCount: 5
  pollingInterval: 5     # seconds between checks
  cooldownPeriod: 30     # seconds to scale down after idle

  rabbitmq:
    queueName: notifications.commands  # queue name in RabbitMQ
    queueLength: "10"                  # messages per replica target
    hostFromEnv: RABBITMQ_CONNECTION_STRING
    vhostName: /
    protocol: amqp


fullnameOverride: notifications

env:
  WORKER_QUEUE: "notifications.commands"
  OTEL_EXPORTER_OTLP_ENDPOINT: "jaeger-collector.observability.svc.cluster.local:4317"
  OTEL_EXPORTER_OTLP_PROTOCOL: "grpc"
  OTEL_EXPORTER_OTLP_INSECURE: "true"
  OTEL_SERVICE_NAME: "notifications-worker"
  OTEL_TRACES_EXPORTER: "otlp"
  OTEL_TRACES_SAMPLER: "always_on"
  OTEL_METRICS_EXPORTER: "none"
  OTEL_LOGS_EXPORTER: "none"
  OTEL_LOG_LEVEL: "debug"

secretRefName: "hireflow-connections"

resources:
  requests: { cpu: 10m, memory: 64Mi }
  limits:   { cpu: 200m, memory: 128Mi }

lifecycle:
  preStop:
    exec:
      command: ["/bin/sh", "-c", "sleep 5"]


terminationGracePeriodSeconds: 30